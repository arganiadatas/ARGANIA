<div id="resultado"></div>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
  async function cargarExcel() {
    // üëá tu link de descarga directa de OneDrive
    let url = "https://onedrive.live.com/download?resid=50D006ED9AE7C0DC!s96b99c7b9ca84dfdb6aa81509cf5961a&migratedtospo=true&redeem=aHR0cHM6Ly8xZHJ2Lm1zL3gvYy81MGQwMDZlZDlhZTdjMGRjL0lRUjduTG1XcUp6OVRiYXFnVkNjOVpZYUFjVnQxQ3Iwei1qbFR5MWhlWHZ3czFV"; 
    
    let resp = await fetch(url);
    let data = await resp.arrayBuffer();
    let workbook = XLSX.read(data, { type: "array" });

    // üìå Seleccionar hoja "Divisas"
    let worksheet = workbook.Sheets["Divisas"];
    if (!worksheet) {
      document.getElementById("resultado").innerText = "‚ùå No existe la hoja 'Divisas'";
      return;
    }

    // Convertir a matriz (arrays de filas y columnas)
    let json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

    // üìå Obtener √∫ltima fila
    let ultimaFila = json[json.length - 1];

    // üìå Columna H = √≠ndice 7 (porque empieza desde 0)
    let ultimaCelda = ultimaFila[7];

    document.getElementById("resultado").innerText =
      "Tipo de cambio (√∫ltima fila H): " + ultimaCelda;
  }

  cargarExcel();
</script>
